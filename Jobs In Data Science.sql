CREATE DATABASE JOBS_IN_DATA_SCIENCE;
USE JOBS_IN_DATA_SCIENCE;

CREATE TABLE IF NOT EXISTS DATA_SCIENCE (
WORK_YEAR INT,
JOB_TITLE VARCHAR(100),
JOB_CATEGORY VARCHAR(100),
SALARY_CURRENCY VARCHAR(20),
SALARY INT,
SALARY_IN_USD INT,
EMPLOYEE_RESIDENCE VARCHAR(100),
EXPERIENCE_LEVEL VARCHAR(50),
EMPLOYMENT_TYPE VARCHAR(50),
WORK_SETTING VARCHAR(50),
COMPANY_LOCATION VARCHAR(100),
COMPANY_SIZE VARCHAR(10));

DROP TABLE DATA_SCIENCE;

LOAD DATA INFILE
'E:/jobs_in_data_science.csv'
INTO TABLE DATA_SCIENCE
FIELDS TERMINATED BY ','
ENCLOSED BY '"'
LINES TERMINATED BY '\n'
IGNORE 1 ROWS;

SELECT * FROM DATA_SCIENCE;

/* Q-1 Find Salary trends with respect to work year? */
SELECT (((MAX(SALARY) - MIN(SALARY)))/MIN(SALARY) * 100) AS SALARY_TREND, WORK_YEAR FROM DATA_SCIENCE  GROUP BY WORK_YEAR ORDER BY SALARY_TREND; /* Trend = Current most value - first value/minimum value * 100 */
/* Q-2 Find salary distribution across various specialized Roles namley Data Scientist, Data Engineer and Data Analyst */
SELECT JOB_TITLE, SALARY, COUNT(SALARY) AS SALARY_DISTRIBUTION FROM DATA_SCIENCE WHERE JOB_TITLE IN('DATA SCIENTIST', 'DATA ENGINEER', 'DATA ANALYST') GROUP BY JOB_TITLE,
SALARY ORDER BY SALARY_DISTRIBUTION; /* Answer is ok */
/* Q-3 Find unique Job Title for which salary range is between 80,000 and 2,00,000? */
SELECT DISTINCT JOB_TITLE, SALARY FROM DATA_SCIENCE WHERE SALARY BETWEEN 80000 AND 200000 GROUP BY SALARY, JOB_TITLE; /* Answer is ok */
/* Q-4 Find Employee Residence whose Salary is in 'USD' and Experience level as 'Senior'? */
SELECT EMPLOYEE_RESIDENCE, SALARY_IN_USD, SALARY_CURRENCY, EXPERIENCE_LEVEL FROM DATA_SCIENCE WHERE SALARY_CURRENCY = 'USD' AND EXPERIENCE_LEVEL = 'SENIOR'; /* Answer is ok */
/* Q-5 Find Total Salary in USD for work setting as 'In-person'? */
SELECT WORK_SETTING, SUM(SALARY) AS TOTAL_SALARY FROM DATA_SCIENCE WHERE WORK_SETTING = 'IN-PERSON' GROUP BY WORK_SETTING ORDER BY TOTAL_SALARY; /* Answer is ok */
/* Q-6 Find the most common Job category with respect to Job Title? */
SELECT JOB_TITLE, JOB_CATEGORY, COUNT(JOB_CATEGORY) AS MOST_COMMON FROM DATA_SCIENCE GROUP BY JOB_TITLE, JOB_CATEGORY ORDER BY MOST_COMMON DESC LIMIT 1; /* Answer is ok */
/* Q-7 Find average salary based on Employment type with respect to work year and Job Title? */
SELECT EMPLOYMENT_TYPE, WORK_YEAR, JOB_TITLE, AVG(SALARY) AS AVERAGE_SALARY FROM DATA_SCIENCE GROUP BY EMPLOYMENT_TYPE, WORK_YEAR, JOB_TITLE
ORDER BY AVERAGE_SALARY, WORK_YEAR ASC; /* Answer is ok */
/* Q-8 Find ratio of medium to large for company size */
SELECT 
COUNT(IF(COMPANY_SIZE = 'M', 1, 0)) COUNT_MEDIUM_SIZE,
COUNT(IF(COMPANY_SIZE = 'L', 1, 0)) COUNT_LARGE_SIZE,
COUNT(IF(COMPANY_SIZE = 'M', 1, 0))/COUNT(IF(COMPANY_SIZE = 'L', 1, 0)) AS RATIO FROM DATA_SCIENCE;

SELECT COUNT(COMPANY_SIZE = 'M') AS COUNT_MEDIUM_SIZE, COUNT(COMPANY_SIZE = 'L') AS COUNT_LARGE_SIZE, COUNT(COMPANY_SIZE = 'M')/COUNT(COMPANY_SIZE = 'L') AS RATIO 
FROM DATA_SCIENCE WHERE COMPANY_SIZE = 'M' AND COMPANY_SIZE = 'L';

SELECT SUM(CASE WHEN 'COMPANY_SIZE' = 'M' THEN 1 ELSE 0 END)/COUNT(*) AS MEDIUM_RATIO,
SUM(CASE WHEN 'COMPANY_SIZE' = 'L' THEN 1 ELSE 0 END)/COUNT(*) AS LARGE_RATIO FROM DATA_SCIENCE;

SELECT COUNT(COMPANY_SIZE), COMPANY_SIZE FROM DATA_SCIENCE GROUP BY COMPANY_SIZE ORDER BY COUNT(COMPANY_SIZE) DESC LIMIT 2;
SELECT ((SELECT COUNT(*) FROM DATA_SCIENCE WHERE COMPANY_SIZE = 'M')/(SELECT COUNT(*) FROM DATA_SCIENCE WHERE COMPANY_SIZE = 'L')) AS RATIO FROM DATA_SCIENCE LIMIT 1;
/* Q-9 Find Job Title with respect to work year where 'salary number' is equal to 'salary in USD number' */
SELECT JOB_TITLE, WORK_YEAR, SALARY, SALARY_IN_USD FROM DATA_SCIENCE WHERE EXISTS (SELECT SALARY, SALARY_IN_USD FROM DATA_SCIENCE 
WHERE DATA_SCIENCE.SALARY = DATA_SCIENCE.SALARY_IN_USD AND SALARY > 14000) AND SALARY = SALARY_IN_USD; /* Answer is ok - very very important*/ 
/* Q-10 Classify unique experience level for all records */
SELECT DISTINCT EXPERIENCE_LEVEL, WORK_YEAR, JOB_TITLE, JOB_CATEGORY, SALARY_CURRENCY, SALARY, SALARY_IN_USD, EMPLOYEE_RESIDENCE, EXPERIENCE_LEVEL,
EMPLOYMENT_TYPE, WORK_SETTING,COMPANY_LOCATION, COMPANY_SIZE FROM DATA_SCIENCE; /* Answer is ok - check for other possibility*/

